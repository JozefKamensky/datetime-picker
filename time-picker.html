<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../datetime-input/time-input.html">
<link rel="import" href="datetime-polyfill-picker-mixin.html">
<link rel="import" href="time-element.html">

<script>
  /**
   * Mixin for datetime-picker
   *
   *  @appliesMixin DatetimeMixin
   *  @appliesMixin FormElementMixin
   *  @appliesMixin TimeElementPattern
   *  @appliesMixin SwitchContainerMixin
   *  @appliesMixin DatetimePolyfillPickerMixin
   *
   * @mixinFunction
   * @polymer
   *
   * @param {Object} superClass class to extend
   * @return {Object} extended class
   */
  const TimePickerPattern = superClass => class extends DatetimePolyfillPickerMixin(TimeElementPattern(SwitchContainerMixin(FormElementMixin(DatetimeMixin(superClass))))) { // eslint-disable-line no-unused-vars, no-undef

    static get expectedNativeInputType() {
      return 'time';
    }

    static get replacementInputType() {
      return 'time-input';
    }

    /**
     * custom style content
     * @type {string}
     */
    static get customStyleContent() {
      return `
        ${super.customStyleContent || ''}
        #picker {
          flex-flow: row nowrap;
        }
      `;
    }

    static get pickerTemplate() {
      return `
        <div id="picker" class="dropdown">
          ${this.timeTemplate}
          <div id="buttons">
            ${this.buttonTemplate}
          <div>
        </div>
      `;
    }

    _confirmedDateTimeChanged(confirmedDate, confirmedTime) {
      if (confirmedTime === undefined) {
        this._resetConfirmedValues();
        return; // return, if resseting, so that the picker is not itself resetted
      }

      this.setProperties({
        date: confirmedDate,
        time: confirmedTime
      });
      // asnyc setting the computed the other confirmed values
      this.setProperties({
        confirmedValue: this.value,
        confirmedDatetime: this.datetime
      });
    }

  }
</script>

<dom-module id="time-picker">
  <script>
  /**
   *  `<time-picker>` is a picker for time for **[Polymer](https://github.com/Polymer/polymer)** that can use the **native** input, too. If the **native** picker is choosen and is not supported, this element uses the **polyfill** time-picker. The `<time-element>` will come in place if the native picker is not available or is not explicitly wanted. A range picker is provided by combining the `min`- and `max`-attributes.
   *
   *  ```html
   *    <time-picker value="{{value}}"></time-picker>
   *  ```
   *
   *  If you need an **overlay** then use `overlay-time-picker`, that creates the element in an `overlay-element`, that extends *IronOverlayBehavior* and will create some of its attribute-bindings.
   *
   * Custom property | Description | Default
   * ----------------|-------------|----------
   * `--input-color` | Text-color of the element | `#dadada`
   * `--input-background` | Text-color of the element | `#2b2b2b`
   * `--input-focus-color` | Color of the focussed or hovered inputs and icons | `#f5f5f5`
   * `--input-focus-background` | Background of the focussed or hovered inputs and icons | `--primary-color, #394FE8`
   * `--input-style` | Mixin applied to the inputs | { padding: 0.25em; border-radius: 0.25em; text-align: center; transition: background 250ms cubic-bezier(0.6, 1, 0.2, 1);}`
   * `--input-focus` | Mixin applied to the focussed or hovered inputs | { color: var(--input-focus-color); background: var(--input-focus-background); }`
   * `--input-icon` | Mixin applied to the icons | `{ border-radius: 0.25em; padding: 0.5em; height: 1em; width: 1em; background: transparent; transition: background 150ms cubic-bezier(0.6, 1, 0.2, 1); }`
   * `--input-picker` | Mixin applied to the picker | `{box-shadow: 0 3px 4px 0 rgba(0, 0, 0, 0.14), 0 1px 8px 0 rgba(0, 0, 0, 0.12), 0 3px 3px -2px rgba(0, 0, 0, 0.4); border-radius: 0.25em;}`
   * `--input-picker-padding` | Padding of the picker | `4px`
   * `--input-selection-color` | Text-color of selected texts | `var(--input-focus-color)`
   * `--input-selection-background` | Background of selected texts | `rgba(255,255,255,0.1)`
   * `--time-element` | Mixin applied to the time-element | `{}`
   *
   *  @polymer
   *  @customElement
   *
   *  @appliesMixin TimePickerPattern
   *
   *  @demo demo/index.html
   *  @demo demo/time-picker.html time elements
   *  @demo demo/form.html in a form
   *  @demo demo/music-album.html music album demo
   **/
    class TimePicker extends TimePickerPattern(Polymer.Element) { // eslint-disable-line no-undef

      static get is() {
        return 'time-picker';
      }

      get _hasNative() {
        return TimePicker._hasNative;
      }
    }
    window.customElements.define(TimePicker.is, TimePicker);
  </script>
</dom-module>
